# CRM URBANY

## Descripci√≥n del Proyecto

CRM URBANY es un sistema de gesti√≥n de relaciones con clientes dise√±ado espec√≠ficamente para inmobiliarias. Permite gestionar propiedades, contactos, comunicaciones y automatizar procesos de venta inmobiliaria, mejorando la eficiencia operativa y la experiencia del cliente.

## Objetivos

- Centralizar la gesti√≥n de propiedades inmobiliarias
- Automatizar procesos de comunicaci√≥n con clientes
- Integrar con plataformas de marketing y redes sociales
- Facilitar la colaboraci√≥n entre agentes inmobiliarios
- Proporcionar an√°lisis de datos para la toma de decisiones

## üöÄ Gu√≠a de Instalaci√≥n y Configuraci√≥n

### Prerrequisitos

- **Python 3.8+** (Recomendado: Python 3.11)
- **Git** para clonar el repositorio
- **Postman** para probar los endpoints (opcional)

### 1. Clonar el Repositorio

```bash
git clone <url-del-repositorio>
cd URBANY
```

### 2. Crear y Activar Entorno Virtual

**Windows:**
```bash
python -m venv venv
venv\Scripts\activate
```

**Linux/Mac:**
```bash
python -m venv venv
source venv/bin/activate
```

### 3. Instalar Dependencias

```bash
pip install Django==4.2.7
pip install djangorestframework==3.14.0
pip install djangorestframework-simplejwt==5.3.0
pip install django-cors-headers==4.3.0
pip install drf-yasg==1.21.7
```

**O instalar desde requirements.txt (si est√° disponible):**
```bash
pip install -r requirements.txt
```

### 4. Configurar Variables de Entorno

Crear archivo `.env` basado en `.env.example`:
```bash
cp .env.example .env
```

### 5. Ejecutar Migraciones

```bash
python manage.py migrate
```

### 6. Crear Superusuario

```bash
python manage.py createsuperuser
```

**Credenciales por defecto (para desarrollo):**
- **Email:** admin@urbany.com
- **Contrase√±a:** admin123
- **Nombre:** Admin
- **Apellido:** User

### 7. Iniciar el Servidor

**Para desarrollo con WebSockets:**
```bash
python manage.py runserver
```

**Para producci√≥n con Daphne:**
```bash
daphne -b 0.0.0.0 -p 8000 core.asgi:application
```

El servidor estar√° disponible en: `http://127.0.0.1:8000/`

### 8. Probar WebSockets

**Interfaz de Chat:**
- Visita: `http://127.0.0.1:8000/messaging/chat/`
- Crea una conversaci√≥n y prueba el chat en tiempo real

**Endpoints WebSocket:**
- Chat: `ws://127.0.0.1:8000/ws/chat/<conversation_id>/`
- Notificaciones: `ws://127.0.0.1:8000/ws/notifications/<user_id>/`
- Estado: `ws://127.0.0.1:8000/ws/user-status/<user_id>/`

## üìã URLs Importantes

- **API Base:** `http://127.0.0.1:8000/api/`
- **Documentaci√≥n Swagger:** `http://127.0.0.1:8000/swagger/`
- **API Docs:** `http://127.0.0.1:8000/api/docs/`
- **Panel Admin:** `http://127.0.0.1:8000/admin/`
- **Health Check:** `http://127.0.0.1:8000/api/auth/health/`
- **Chat Interface:** `http://127.0.0.1:8000/messaging/chat/`

### WebSocket URLs
- **Chat:** `ws://127.0.0.1:8000/ws/chat/<conversation_id>/`
- **Notificaciones:** `ws://127.0.0.1:8000/ws/notifications/<user_id>/`
- **Estado Usuario:** `ws://127.0.0.1:8000/ws/user-status/<user_id>/`

## üîß Configuraci√≥n para Postman

### Variables de Entorno
```json
{
  "base_url": "http://127.0.0.1:8000",
  "access_token": "",
  "refresh_token": "",
  "user_id": ""
}
```

### Headers Globales
- `Content-Type: application/json`
- `Authorization: Bearer {{access_token}}`

## üß™ Verificaci√≥n de Instalaci√≥n

### 1. Verificar Health Check
```bash
curl http://127.0.0.1:8000/api/auth/health/
```

### 2. Probar Registro de Usuario
```bash
curl -X POST http://127.0.0.1:8000/api/auth/register/ \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "testpass123",
    "password_confirm": "testpass123",
    "first_name": "Test",
    "last_name": "User"
  }'
```

### 3. Probar Login
```bash
curl -X POST http://127.0.0.1:8000/api/auth/login/ \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@urbany.com",
    "password": "admin123"
  }'
```

## Estado Actual del Proyecto - MODULO 01

**Versi√≥n**: 1.0.0 (Desarrollo)  
**√öltima Actualizaci√≥n**: Enero 2025

### Cambios Recientes Implementados

#### üîß Modificaciones Estructurales
- **Limpieza de C√≥digo**: Eliminaci√≥n de archivos no esenciales (`admin.py` vac√≠os, `models.py` sin funcionalidad)
- **Optimizaci√≥n de Aplicaciones**: Mantenimiento solo del c√≥digo esencial en cada aplicaci√≥n
- **Documentaci√≥n Completa**: Cada aplicaci√≥n ahora cuenta con documentaci√≥n detallada de su prop√≥sito y funcionalidades

#### üóÑÔ∏è Base de Datos
- **Nueva Tabla de Testing**: Creaci√≥n de tabla `usuarios` en SQLite3 para pruebas del sistema de login
  - Campos: `id` (INTEGER PRIMARY KEY), `usuario` (TEXT UNIQUE), `contrase√±a` (TEXT), `fecha_creacion` (TIMESTAMP)
  - Incluye medidas de seguridad b√°sicas para almacenamiento de credenciales
  - Usuario de prueba preconfigurado para testing

#### üèóÔ∏è Arquitectura Actual
El sistema est√° implementado con Django REST Framework y consta de las siguientes aplicaciones:

1. **Core** (`core/`): Configuraci√≥n central del sistema
2. **Authentication** (`authentication/`): Sistema de autenticaci√≥n JWT
3. **Users** (`users/`): Gesti√≥n de usuarios y perfiles
4. **Roles** (`roles/`): Sistema de roles y permisos

## Aplicaciones Implementadas

### 1. Aplicaci√≥n Core
**Ubicaci√≥n**: `core/`  
**Prop√≥sito**: N√∫cleo central del sistema con configuraci√≥n global

**Funcionalidades**:
- Configuraci√≥n de Django y DRF
- Enrutamiento global de URLs
- Configuraci√≥n de seguridad y JWT
- Configuraci√≥n de base de datos SQLite3
- Documentaci√≥n autom√°tica con Swagger/OpenAPI

### 2. Aplicaci√≥n Authentication
**Ubicaci√≥n**: `authentication/`  
**Prop√≥sito**: Gesti√≥n completa de autenticaci√≥n de usuarios

**Funcionalidades**:
- Registro de usuarios con validaci√≥n de email
- Login con tokens JWT (access/refresh)
- Recuperaci√≥n de contrase√±as
- Autenticaci√≥n de dos factores (2FA)
- Health check del sistema

### 3. Aplicaci√≥n Users
**Ubicaci√≥n**: `users/`  
**Prop√≥sito**: Gesti√≥n de usuarios y perfiles

**Funcionalidades**:
- Modelo de usuario extendido con campos personalizados
- Gesti√≥n de perfiles de usuario
- Cambio de contrase√±as
- Asignaci√≥n de roles
- Estad√≠sticas de usuarios

### 4. Aplicaci√≥n Roles
**Ubicaci√≥n**: `roles/`  
**Prop√≥sito**: Sistema de roles y permisos

**Funcionalidades**:
- CRUD de roles y permisos
- Asignaci√≥n de permisos a roles
- Gesti√≥n de usuarios por rol
- Estad√≠sticas de roles y permisos

## M√≥dulos y Equipos Responsables

El proyecto est√° dividido en 4 m√≥dulos principales:

## M√≥dulo 1: Autenticaci√≥n y Gesti√≥n de Usuarios

### Descripci√≥n General
Sistema encargado de todos los procesos de autenticaci√≥n, registro y administraci√≥n de usuarios en el CRM URBANY.

### Arquitectura y Componentes Principales
- **Sistema de Autenticaci√≥n**: Gestiona login, registro y recuperaci√≥n de contrase√±as
- **Gesti√≥n de Usuarios**: Administra perfiles y datos personales
- **Sistema de Roles**: Implementa permisos y roles de usuario
- **API REST**: Proporciona endpoints para operaciones de usuario

### Dependencias y Requisitos
- Django 4.2+
- Django REST Framework
- JWT para autenticaci√≥n
- PostgreSQL para almacenamiento de datos
- M√≥dulo 4 para gesti√≥n de permisos en redes inmobiliarias

### Estructura de Directorios
```
modulo1/
‚îú‚îÄ‚îÄ auth/                  # Componentes de autenticaci√≥n
‚îú‚îÄ‚îÄ users/                 # Gesti√≥n de usuarios
‚îú‚îÄ‚îÄ roles/                 # Sistema de roles
‚îî‚îÄ‚îÄ api/                   # Endpoints de API
```

### Configuraci√≥n Necesaria
- Configuraci√≥n de base de datos PostgreSQL
- Configuraci√≥n de JWT para tokens de autenticaci√≥n
- Configuraci√≥n de permisos y roles iniciales

### Equipo Responsable
Backend 1

## M√≥dulo 5: Sistema de Mensajer√≠a en Tiempo Real

### Descripci√≥n General
Sistema de comunicaci√≥n en tiempo real que permite chat entre usuarios, notificaciones instant√°neas y seguimiento de estado de usuarios.

### Arquitectura y Componentes Principales
- **Django Channels**: Framework para WebSockets y comunicaci√≥n as√≠ncrona
- **WebSocket Consumers**: Manejadores de conexiones WebSocket
- **Channel Layers**: Sistema de mensajer√≠a entre procesos
- **Sistema de Chat**: Chat en tiempo real entre usuarios
- **Notificaciones**: Sistema de notificaciones instant√°neas
- **Estado de Usuario**: Seguimiento de estado online/offline

### Funcionalidades Implementadas
- **Chat en Tiempo Real**: Mensajer√≠a instant√°nea entre usuarios
- **Indicadores de Escritura**: Notificaci√≥n cuando un usuario est√° escribiendo
- **Confirmaciones de Lectura**: Seguimiento de mensajes le√≠dos
- **Reacciones a Mensajes**: Sistema de reacciones (like, love, etc.)
- **Estado de Usuario**: Seguimiento de estado online/offline/ausente
- **Notificaciones Autom√°ticas**: Notificaciones de nuevos mensajes y actividades

### WebSocket Endpoints
- `ws://localhost:8000/ws/chat/<conversation_id>/` - Chat en tiempo real
- `ws://localhost:8000/ws/notifications/<user_id>/` - Notificaciones instant√°neas
- `ws://localhost:8000/ws/user-status/<user_id>/` - Estado de usuario

### Dependencias y Requisitos
- Django Channels 4.0+
- Daphne (servidor ASGI)
- Redis para Channel Layers (opcional, usa in-memory para desarrollo)
- WebSocket support en el navegador

### Configuraci√≥n Necesaria
- Configuraci√≥n ASGI en lugar de WSGI
- Channel Layers configurado
- Routing de WebSockets
- Consumers implementados

### Equipo Responsable
Backend 4

## M√≥dulo 2: Gesti√≥n de Propiedades

### Descripci√≥n General
M√≥dulo que maneja la creaci√≥n, edici√≥n y publicaci√≥n de propiedades inmobiliarias en el sistema.

### Arquitectura y Componentes Principales
- **Gesti√≥n de Propiedades**: Administra datos b√°sicos de propiedades
- **Sistema Multimedia**: Gestiona im√°genes y documentos
- **Motor de B√∫squeda**: Implementa b√∫squeda y filtrado avanzado
- **API REST**: Proporciona endpoints para operaciones con propiedades

### Dependencias y Requisitos
- Django 4.2+
- Django REST Framework
- PostgreSQL con extensi√≥n PostGIS para geolocalizaci√≥n
- Pillow para manejo de im√°genes
- M√≥dulo 1 para asignaci√≥n de propiedades a usuarios
- M√≥dulo 3 para promoci√≥n y publicaci√≥n de propiedades

### Estructura de Directorios
```
modulo2/
‚îú‚îÄ‚îÄ properties/            # Gesti√≥n de propiedades
‚îú‚îÄ‚îÄ media/                 # Gesti√≥n de archivos multimedia
‚îú‚îÄ‚îÄ search/                # Sistema de b√∫squeda
‚îî‚îÄ‚îÄ api/                   # Endpoints de API
```

### Configuraci√≥n Necesaria
- Configuraci√≥n de almacenamiento para archivos multimedia
- Configuraci√≥n de PostGIS para geolocalizaci√≥n
- Configuraci√≥n de indexaci√≥n para b√∫squedas

### Equipo Responsable
Backend 2

## M√≥dulo 3: Comunicaci√≥n y Marketing

### Descripci√≥n General
M√≥dulo que gestiona todas las comunicaciones con clientes y las integraciones con plataformas de marketing.

### Arquitectura y Componentes Principales
- **Sistema de Comunicaciones**: Gestiona env√≠o de mensajes a clientes
- **Plantillas**: Administra plantillas para diferentes tipos de comunicaci√≥n
- **Integraciones Externas**: Conecta con plataformas de marketing
- **API REST**: Proporciona endpoints para operaciones de comunicaci√≥n

### Dependencias y Requisitos
- Django 4.2+
- Celery para tareas as√≠ncronas
- APIs de integraci√≥n (MyPerfit, Instagram, WhatsApp)
- Redis para colas de mensajes
- M√≥dulo 1 para informaci√≥n de usuarios
- M√≥dulo 2 para datos de propiedades en campa√±as

### Estructura de Directorios
```
modulo3/
‚îú‚îÄ‚îÄ communications/        # Gesti√≥n de comunicaciones
‚îú‚îÄ‚îÄ templates/             # Plantillas de comunicaci√≥n
‚îú‚îÄ‚îÄ integrations/          # Integraciones con plataformas externas
‚îî‚îÄ‚îÄ api/                   # Endpoints de API
```

### Configuraci√≥n Necesaria
- Configuraci√≥n de Celery y Redis
- Configuraci√≥n de APIs externas
- Configuraci√≥n de plantillas predeterminadas

### Equipo Responsable
Backend 3

## M√≥dulo 4: Redes Inmobiliarias y Colaboraci√≥n

### Descripci√≥n General
M√≥dulo que gestiona la creaci√≥n de redes inmobiliarias, invitaciones y compartici√≥n de propiedades entre agentes.

### Arquitectura y Componentes Principales
- **Gesti√≥n de Redes**: Administra redes inmobiliarias
- **Sistema de Invitaciones**: Gestiona invitaciones a redes
- **Compartici√≥n de Propiedades**: Permite compartir propiedades entre agentes
- **API REST**: Proporciona endpoints para operaciones de colaboraci√≥n

### Dependencias y Requisitos
- Django 4.2+
- Django Channels para comunicaci√≥n en tiempo real
- PostgreSQL para almacenamiento de datos
- WebSockets para notificaciones en tiempo real
- M√≥dulo 1 para gesti√≥n de permisos de usuarios
- M√≥dulo 2 para compartir propiedades

### Estructura de Directorios
```
modulo4/
‚îú‚îÄ‚îÄ networks/              # Gesti√≥n de redes inmobiliarias
‚îú‚îÄ‚îÄ invitations/           # Sistema de invitaciones
‚îú‚îÄ‚îÄ sharing/               # Compartici√≥n de propiedades
‚îú‚îÄ‚îÄ activities/            # Seguimiento de actividades
‚îú‚îÄ‚îÄ navigation/            # Sistema de navegaci√≥n
‚îú‚îÄ‚îÄ dashboard/             # Panel de control
‚îú‚îÄ‚îÄ reports/               # Sistema de reportes
‚îú‚îÄ‚îÄ alerts/                # Sistema de alertas
‚îú‚îÄ‚îÄ contracts/             # Gesti√≥n de contratos
‚îú‚îÄ‚îÄ messaging/             # Sistema de mensajer√≠a en tiempo real
‚îî‚îÄ‚îÄ api/                   # Endpoints de API
```

### Configuraci√≥n Necesaria
- Configuraci√≥n de Django Channels
- Configuraci√≥n de WebSockets
- Configuraci√≥n de permisos de compartici√≥n

## Historias de Usuario


###  Modulo Desarrollo (Backend)
- HU01: Autenticaci√≥n de usuario en el sistema CRM URBANY
- HU03: Registro de usuario individual en CRM URBANY
- HU14: Gesti√≥n de propiedades inmobiliarias
- HU16: Gesti√≥n de contactos y clientes potenciales
- HU19: Seguimiento de actividades y tareas
- HU20: Gesti√≥n de calendario y citas
- HU21: Configuraci√≥n de notificaciones y alertas
- HU26: Gesti√≥n de redes inmobiliarias
- HU27: An√°lisis y reportes de actividad
- HU28: Configuraci√≥n de permisos y roles
- HU30: Integraci√≥n con APIs externas
- HU31: Gesti√≥n de documentos y archivos

### Modulos Maqueta (Simulaci√≥n)
- HU02: Registro inicial de inmobiliaria en CRM URBANY
- HU04: Gesti√≥n de plantillas de email para respuestas autom√°ticas
- HU05: Configuraci√≥n de automatizaci√≥n para notificaci√≥n de nuevas propiedades
- HU06: Integraci√≥n de correo electr√≥nico profesional con el CRM
- HU07: Integraci√≥n con redes inmobiliarias para mayor alcance
- HU08: Gesti√≥n de invitaciones y creaci√≥n de redes inmobiliarias
- HU09: Integraci√≥n con plataformas de email marketing
- HU10: Configuraci√≥n de integraci√≥n con MyPerfit para Email Marketing
- HU11: Integraci√≥n de redes sociales - Instagram Business y WhatsApp Business
- HU12: Configuraci√≥n de integraciones oficiales y alternativas
- HU13: Configuraci√≥n de integraciones con portales inmobiliarios
- HU15: Gesti√≥n de leads y oportunidades de venta
- HU17: Automatizaci√≥n de seguimiento de clientes
- HU18: Configuraci√≥n de flujos de trabajo automatizados
- HU22: Personalizaci√≥n de dashboard y widgets
- HU23: Configuraci√≥n de preferencias de usuario
- HU24: Gesti√≥n de equipos y colaboradores
- HU25: Configuraci√≥n de marca y personalizaci√≥n visual

## Estructura de Directorios Actual - PROYECTO COMPLETO

```
URBANY/
‚îú‚îÄ‚îÄ core/                  # Configuraci√≥n central del sistema
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ settings.py        # Configuraci√≥n principal de Django
‚îÇ   ‚îú‚îÄ‚îÄ urls.py           # URLs globales del sistema
‚îÇ   ‚îú‚îÄ‚îÄ wsgi.py           # Configuraci√≥n WSGI
‚îÇ   ‚îú‚îÄ‚îÄ asgi.py           # Configuraci√≥n ASGI para WebSockets
‚îÇ   ‚îî‚îÄ‚îÄ README.md         # Documentaci√≥n del core
‚îú‚îÄ‚îÄ authentication/        # Sistema de autenticaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ apps.py
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores para autenticaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de autenticaci√≥n (registro, login, etc.)
‚îÇ   ‚îú‚îÄ‚îÄ urls.py           # URLs de autenticaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ tests.py          # Pruebas unitarias
‚îÇ   ‚îî‚îÄ‚îÄ README.md         # Documentaci√≥n de autenticaci√≥n
‚îú‚îÄ‚îÄ users/                 # Gesti√≥n de usuarios
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ apps.py
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelo de usuario extendido
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de usuario
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de usuarios
‚îÇ   ‚îú‚îÄ‚îÄ urls.py           # URLs de usuarios
‚îÇ   ‚îú‚îÄ‚îÄ tests.py          # Pruebas unitarias
‚îÇ   ‚îî‚îÄ‚îÄ README.md         # Documentaci√≥n de usuarios
‚îú‚îÄ‚îÄ roles/                 # Sistema de roles y permisos
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ apps.py
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelos de roles y permisos
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de roles
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de roles
‚îÇ   ‚îú‚îÄ‚îÄ urls.py           # URLs de roles
‚îÇ   ‚îú‚îÄ‚îÄ tests.py          # Pruebas unitarias
‚îÇ   ‚îî‚îÄ‚îÄ README.md         # Documentaci√≥n de roles
‚îú‚îÄ‚îÄ networks/              # Gesti√≥n de redes inmobiliarias
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelos de redes
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de redes
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de redes
‚îÇ   ‚îî‚îÄ‚îÄ urls.py           # URLs de redes
‚îú‚îÄ‚îÄ invitations/           # Sistema de invitaciones
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelos de invitaciones
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de invitaciones
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de invitaciones
‚îÇ   ‚îî‚îÄ‚îÄ urls.py           # URLs de invitaciones
‚îú‚îÄ‚îÄ sharing/               # Compartici√≥n de propiedades
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelos de compartici√≥n
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de compartici√≥n
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de compartici√≥n
‚îÇ   ‚îî‚îÄ‚îÄ urls.py           # URLs de compartici√≥n
‚îú‚îÄ‚îÄ activities/            # Seguimiento de actividades
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelos de actividades
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de actividades
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de actividades
‚îÇ   ‚îî‚îÄ‚îÄ urls.py           # URLs de actividades
‚îú‚îÄ‚îÄ navigation/            # Sistema de navegaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelos de navegaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de navegaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de navegaci√≥n
‚îÇ   ‚îî‚îÄ‚îÄ urls.py           # URLs de navegaci√≥n
‚îú‚îÄ‚îÄ dashboard/             # Panel de control
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelos de dashboard
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de dashboard
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de dashboard
‚îÇ   ‚îî‚îÄ‚îÄ urls.py           # URLs de dashboard
‚îú‚îÄ‚îÄ reports/               # Sistema de reportes
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelos de reportes
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de reportes
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de reportes
‚îÇ   ‚îî‚îÄ‚îÄ urls.py           # URLs de reportes
‚îú‚îÄ‚îÄ alerts/                # Sistema de alertas
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelos de alertas
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de alertas
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de alertas
‚îÇ   ‚îî‚îÄ‚îÄ urls.py           # URLs de alertas
‚îú‚îÄ‚îÄ contracts/             # Gesti√≥n de contratos
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelos de contratos
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de contratos
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de contratos
‚îÇ   ‚îî‚îÄ‚îÄ urls.py           # URLs de contratos
‚îú‚îÄ‚îÄ messaging/             # Sistema de mensajer√≠a en tiempo real
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # Modelos de mensajer√≠a
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py    # Serializadores de mensajer√≠a
‚îÇ   ‚îú‚îÄ‚îÄ views.py          # Vistas de gesti√≥n de mensajer√≠a
‚îÇ   ‚îú‚îÄ‚îÄ urls.py           # URLs de mensajer√≠a
‚îÇ   ‚îú‚îÄ‚îÄ consumers.py      # WebSocket consumers
‚îÇ   ‚îú‚îÄ‚îÄ routing.py        # Routing de WebSockets
‚îÇ   ‚îú‚îÄ‚îÄ channel_layers.py # Channel layers personalizados
‚îÇ   ‚îî‚îÄ‚îÄ templates/        # Plantillas de chat
‚îú‚îÄ‚îÄ static/                # Archivos est√°ticos
‚îú‚îÄ‚îÄ media/                 # Archivos multimedia
‚îú‚îÄ‚îÄ templates/             # Plantillas globales
‚îú‚îÄ‚îÄ db.sqlite3            # Base de datos SQLite3
‚îú‚îÄ‚îÄ manage.py             # Script de gesti√≥n de Django
‚îú‚îÄ‚îÄ requirements.txt      # Dependencias del proyecto
‚îî‚îÄ‚îÄ README.md             # Documentaci√≥n principal (este archivo)
```

## Tecnolog√≠as Implementadas

### Backend
- **Django 4.2+**: Framework web principal
- **Django REST Framework**: Framework para APIs REST
- **Django Channels 4.0+**: Framework para WebSockets y comunicaci√≥n en tiempo real
- **SQLite3**: Base de datos para desarrollo y testing
- **JWT (Simple JWT)**: Autenticaci√≥n basada en tokens
- **drf-yasg**: Documentaci√≥n autom√°tica de API
- **Daphne**: Servidor ASGI para WebSockets

### Comunicaci√≥n en Tiempo Real
- **WebSockets**: Protocolo de comunicaci√≥n bidireccional
- **ASGI**: Interface as√≠ncrona para aplicaciones web
- **Channel Layers**: Sistema de mensajer√≠a entre procesos
- **Redis**: Backend para Channel Layers (opcional, usa in-memory para desarrollo)

### Filtros y B√∫squeda
- **django-filter**: Sistema de filtros avanzados para APIs
- **DjangoFilterBackend**: Backend de filtros para DRF

### Validaci√≥n y Datos
- **django-phonenumber-field**: Validaci√≥n de n√∫meros telef√≥nicos
- **phonenumbers**: Librer√≠a de validaci√≥n de n√∫meros telef√≥nicos

### Seguridad
- **CORS Headers**: Configuraci√≥n de Cross-Origin Resource Sharing
- **JWT Authentication**: Tokens de acceso y refresh
- **Password Hashing**: Encriptaci√≥n segura de contrase√±as
- **Permission System**: Sistema de permisos granular

### Documentaci√≥n
- **Swagger UI**: Interfaz interactiva de documentaci√≥n API
- **ReDoc**: Documentaci√≥n alternativa de API
- **OpenAPI Schema**: Esquema est√°ndar de documentaci√≥n

### Desarrollo y Testing
- **pytest**: Framework de testing
- **pytest-django**: Plugin de pytest para Django
- **coverage**: An√°lisis de cobertura de c√≥digo
- **factory-boy**: Generaci√≥n de datos de prueba

## APIs Disponibles

### Autenticaci√≥n (`/api/auth/`)
- `POST /api/auth/register/` - Registro de usuarios
- `POST /api/auth/login/` - Inicio de sesi√≥n
- `POST /api/auth/logout/` - Cierre de sesi√≥n
- `POST /api/auth/password-recovery/` - Recuperaci√≥n de contrase√±a
- `POST /api/auth/two-factor/` - Autenticaci√≥n de dos factores
- `GET /api/auth/health/` - Estado del sistema

### Usuarios (`/api/users/`)
- `GET /api/users/` - Lista de usuarios
- `POST /api/users/` - Crear usuario
- `GET /api/users/{id}/` - Detalle de usuario
- `PUT /api/users/{id}/` - Actualizar usuario
- `DELETE /api/users/{id}/` - Eliminar usuario
- `POST /api/users/{id}/change-password/` - Cambiar contrase√±a
- `GET /api/users/statistics/` - Estad√≠sticas de usuarios

### Roles (`/api/roles/`)
- `GET /api/roles/` - Lista de roles
- `POST /api/roles/` - Crear rol
- `GET /api/roles/{id}/` - Detalle de rol
- `PUT /api/roles/{id}/` - Actualizar rol
- `DELETE /api/roles/{id}/` - Eliminar rol
- `POST /api/roles/{id}/add-permission/` - Agregar permiso
- `POST /api/roles/{id}/remove-permission/` - Remover permiso
- `GET /api/roles/permissions/` - Lista de permisos
- `GET /api/roles/statistics/` - Estad√≠sticas de roles

### Mensajer√≠a (`/api/messaging/`)
- `GET /api/messaging/conversations/` - Lista de conversaciones
- `POST /api/messaging/conversations/` - Crear conversaci√≥n
- `GET /api/messaging/conversations/{id}/` - Detalle de conversaci√≥n
- `GET /api/messaging/conversations/{id}/messages/` - Mensajes de conversaci√≥n
- `POST /api/messaging/conversations/{id}/messages/` - Enviar mensaje
- `POST /api/messaging/messages/{id}/react/` - Reaccionar a mensaje
- `DELETE /api/messaging/messages/{id}/react/` - Quitar reacci√≥n
- `GET /api/messaging/stats/` - Estad√≠sticas de mensajer√≠a
- `GET /api/messaging/status/` - Estado de usuario

### WebSocket Endpoints
- `ws://localhost:8000/ws/chat/<conversation_id>/` - Chat en tiempo real
- `ws://localhost:8000/ws/notifications/<user_id>/` - Notificaciones instant√°neas
- `ws://localhost:8000/ws/user-status/<user_id>/` - Estado de usuario

### Redes (`/api/networks/`)
- `GET /api/networks/` - Lista de redes inmobiliarias
- `POST /api/networks/` - Crear red
- `GET /api/networks/{id}/` - Detalle de red
- `PUT /api/networks/{id}/` - Actualizar red
- `DELETE /api/networks/{id}/` - Eliminar red

### Invitaciones (`/api/invitations/`)
- `GET /api/invitations/` - Lista de invitaciones
- `POST /api/invitations/` - Crear invitaci√≥n
- `GET /api/invitations/{id}/` - Detalle de invitaci√≥n
- `POST /api/invitations/{id}/accept/` - Aceptar invitaci√≥n
- `POST /api/invitations/{id}/reject/` - Rechazar invitaci√≥n

### Actividades (`/api/activities/`)
- `GET /api/activities/` - Lista de actividades
- `POST /api/activities/` - Crear actividad
- `GET /api/activities/{id}/` - Detalle de actividad
- `PUT /api/activities/{id}/` - Actualizar actividad
- `DELETE /api/activities/{id}/` - Eliminar actividad

### Dashboard (`/api/dashboard/`)
- `GET /api/dashboard/metrics/` - M√©tricas del dashboard
- `GET /api/dashboard/charts/` - Datos de gr√°ficos
- `GET /api/dashboard/activities/` - Actividades recientes

### Reportes (`/api/reports/`)
- `GET /api/reports/` - Lista de reportes
- `POST /api/reports/` - Crear reporte
- `GET /api/reports/{id}/` - Detalle de reporte
- `POST /api/reports/{id}/generate/` - Generar reporte

### Alertas (`/api/alerts/`)
- `GET /api/alerts/` - Lista de alertas
- `POST /api/alerts/` - Crear alerta
- `GET /api/alerts/{id}/` - Detalle de alerta
- `PUT /api/alerts/{id}/` - Actualizar alerta
- `DELETE /api/alerts/{id}/` - Eliminar alerta

### Contratos (`/api/contracts/`)
- `GET /api/contracts/` - Lista de contratos
- `POST /api/contracts/` - Crear contrato
- `GET /api/contracts/{id}/` - Detalle de contrato
- `PUT /api/contracts/{id}/` - Actualizar contrato
- `DELETE /api/contracts/{id}/` - Eliminar contrato

### Documentaci√≥n (`/api/`)
- `GET /api/schema/` - Esquema OpenAPI
- `GET /api/docs/` - Documentaci√≥n Swagger UI
- `GET /api/redoc/` - Documentaci√≥n ReDoc

## Configuraci√≥n de Desarrollo

### Requisitos Previos
- Python 3.8+
- pip (gestor de paquetes de Python)

### Instalaci√≥n R√°pida

1. **Clonar el repositorio**:
   ```bash
   git clone [URL_DEL_REPOSITORIO]
   cd URBANY
   ```

2. **Crear entorno virtual**:
   ```bash
   python -m venv venv
   
   # Windows
   venv\Scripts\activate
   
   # macOS/Linux
   source venv/bin/activate
   ```

3. **Instalar dependencias**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Aplicar migraciones**:
   ```bash
   python manage.py migrate
   ```

5. **Crear superusuario** (opcional):
   ```bash
   python manage.py createsuperuser
   ```

6. **Iniciar servidor de desarrollo**:
   ```bash
   python manage.py runserver
   ```

7. **Acceder a la documentaci√≥n**:
   - Swagger UI: http://localhost:8000/api/docs/
   - ReDoc: http://localhost:8000/api/redoc/

### Testing

#### Ejecutar todas las pruebas:
```bash
python manage.py test
```

#### Ejecutar pruebas por aplicaci√≥n:
```bash
python manage.py test authentication
python manage.py test users
python manage.py test roles
```

#### Tabla de Testing 'usuarios'
La tabla `usuarios` est√° disponible para pruebas del sistema de login:
- **Usuario de prueba**: `testuser`
- **Contrase√±a**: `testpass123`
- **Fecha de creaci√≥n**: Autom√°tica

## Pr√≥ximos Desarrollos Planificados

## Licencia

MIT

¬© 2021-2025 CRM URBANY. Todos los derechos reservados.
